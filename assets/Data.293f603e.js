import{G as be,a as p,b as V,o as D,j as re,H as Ee,c as i,I as W,i as r,d as b,k as Pe,s as _,S as L,F as $e,e as ze,f as _e,t as h,A as Ae,B as Ie,J as K}from"./index.68556472.js";async function Ne(n){let e="";return n.zip_code.forEach(s=>e+="zip_code="+s.id+"&"),n.type.forEach(s=>e+="type="+s.id+"&"),n.pollutant.forEach(s=>e+="pollutant="+s.id+"&"),(await(await fetch(`https://mrapid-api3-r2oaltsiuq-uc.a.run.app/sensor?${e}`)).json()).SensorList}async function Fe(n){let e="";return n.sensor.forEach(s=>e+="sensor="+s.id+"&"),n.pollutant.forEach(s=>e+="pollutant="+s.id+"&"),n.pollutant.forEach(s=>e+="unit="+s.name.split(" ").pop()+"&"),e+="start="+n.start+"&",e+="end="+n.end+"&",e+="step="+n.step+"&",console.log(e),await(await fetch(`https://mrapid-api3-r2oaltsiuq-uc.a.run.app/history?${e}`)).json()}const Te=function(n){let e=[];const l=Object.keys(n[0]);e.push(l.join(","));for(const u of n){const d=l.map(S=>u[S]);e.push(d.join(","))}e=e.join(`
`),console.log(e);const t=new Blob([e],{type:"text/csv"}),s=window.URL.createObjectURL(t),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download","download.csv"),a.click()},Le=n=>{const e=be({multiple:!1,disabled:!1,optionToValue:o=>o,isOptionDisabled:o=>!1},n),l=o=>{if(e.multiple&&Array.isArray(o))return o;if(!e.multiple&&!Array.isArray(o))return o!==null?[o]:[];throw new Error(`Incompatible value type for ${e.multiple?"multple":"single"} select.`)},[t,s]=p(e.initialValue!==void 0?l(e.initialValue):[]),a=()=>e.multiple?t():t()[0]||null,u=o=>s(l(o)),d=()=>s([]),S=()=>!!(e.multiple?a().length:a());V(D(t,()=>e.onChange?.(a()),{defer:!0}));const[f,y]=p(""),R=()=>y(""),Z=()=>!!f().length;V(D(f,o=>e.onInput?.(o),{defer:!0})),V(D(f,o=>{o&&!m()&&g(!0)},{defer:!0}));const k=typeof e.options=="function"?re(()=>e.options(f()),e.options(f())):()=>e.options,U=()=>k().length,O=o=>{if(e.isOptionDisabled(o))return;const w=e.optionToValue(o);e.multiple?u([...t(),w]):(u(w),E(!1)),g(!1)},[q,E]=p(!1),[m,g]=p(!1),z=()=>g(!m()),[P,A]=p(-1),x=()=>k()[P()],I=o=>o===x(),G=o=>{U()||A(-1);const w=U()-1,ne=o==="next"?1:-1;let $=P()+ne;$>w&&($=0),$<0&&($=w),A($)},H=()=>G("previous"),J=()=>G("next");V(D(k,o=>{m()&&A(Math.min(0,o.length-1))},{defer:!0})),V(D(()=>e.disabled,o=>{o&&m()&&g(!1)})),V(D(m,o=>{o?(P()===-1&&J(),E(!0)):(P()>-1&&A(-1),y(""))},{defer:!0})),V(D(P,o=>{o>-1&&!m()&&g(!0)},{defer:!0}));const N=()=>E(!0),X=()=>{E(!1),g(!1)},F=o=>o.preventDefault(),T=o=>{!e.disabled&&!Z()&&z()},ee=o=>{y(o.target.value)},te=o=>{switch(o.key){case"ArrowDown":J();break;case"ArrowUp":H();break;case"Enter":if(m()&&x()){O(x());break}return;case"Escape":if(m()){g(!1);break}return;case"Delete":case"Backspace":if(f())return;if(e.multiple){const w=a();u([...w.slice(0,-1)])}else d();break;case" ":if(f())return;m()?x()&&O(x()):g(!0);break;case"Tab":if(x()&&m()){O(x());break}return;default:return}o.preventDefault(),o.stopPropagation()};return{options:k,value:a,setValue:u,hasValue:S,clearValue:d,inputValue:f,setInputValue:y,hasInputValue:Z,clearInputValue:R,isOpen:m,setIsOpen:g,toggleOpen:z,isActive:q,setIsActive:E,get multiple(){return e.multiple},get disabled(){return e.disabled},pickOption:O,isOptionFocused:I,isOptionDisabled:e.isOptionDisabled,onFocusIn:N,onFocusOut:X,onMouseDown:F,onClick:T,onInput:ee,onKeyDown:te}},je=h("<div></div>",2),Me=h('<div class="solid-select-control"></div>',2),Be=h('<div class="solid-select-placeholder"></div>',2),Re=h('<div class="solid-select-single-value"></div>',2),Ze=h('<div class="solid-select-multi-value"><button type="button" class="solid-select-multi-value-remove">\u2A2F</button></div>',4),Ue=h('<input class="solid-select-input" type="text" tabindex="0" autocomplete="off" autocapitalize="none" size="1">',1),Ge=h('<div class="solid-select-list"></div>',2),ge=h('<div class="solid-select-list-placeholder"></div>',2),He=h('<div class="solid-select-option"></div>',2),Se=Ae(),j=()=>{const n=Ie(Se);if(!n)throw new Error("No SelectContext found in ancestry.");return n},Q=n=>{const[e,l]=Ee(be({format:(s,a)=>s,placeholder:"Select...",readonly:typeof n.options!="function",loading:!1,loadingPlaceholder:"Loading...",emptyPlaceholder:"No options"},n),["options","optionToValue","isOptionDisabled","multiple","disabled","onInput","onChange"]),t=Le(e);return V(D(()=>l.initialValue,s=>s!==void 0&&t.setValue(s))),i(Se.Provider,{value:t,get children(){return i(Je,{get class(){return l.class},get children(){return[i(Ke,{get id(){return l.id},get name(){return l.name},get format(){return l.format},get placeholder(){return l.placeholder},get autofocus(){return l.autofocus},get readonly(){return l.readonly}}),i(Xe,{get loading(){return l.loading},get loadingPlaceholder(){return l.loadingPlaceholder},get emptyPlaceholder(){return l.emptyPlaceholder},get format(){return l.format}})]}})}})},Je=n=>{const e=j();return(()=>{const l=je.cloneNode(!0);return l.$$mousedown=t=>{e.onMouseDown(t),t.currentTarget.getElementsByTagName("input")[0].focus()},W(l,"focusout",e.onFocusOut,!0),W(l,"focusin",e.onFocusIn,!0),r(l,()=>n.children),b(t=>{const s=`solid-select-container ${n.class!==void 0?n.class:""}`,a=e.disabled;return s!==t._v$&&Pe(l,t._v$=s),a!==t._v$2&&_(l,"data-disabled",t._v$2=a),t},{_v$:void 0,_v$2:void 0}),l})()},Ke=n=>{const e=j(),l=t=>{const s=e.value();e.setValue([...s.slice(0,t),...s.slice(t+1)])};return(()=>{const t=Me.cloneNode(!0);return W(t,"click",e.onClick,!0),r(t,i(L,{get when(){return re(()=>!e.hasValue())()&&!e.hasInputValue()},get children(){return i(Qe,{get children(){return n.placeholder}})}}),null),r(t,i(L,{get when(){return re(()=>!!(e.hasValue()&&!e.multiple))()&&!e.hasInputValue()},get children(){return i(We,{get children(){return n.format(e.value(),"value")}})}}),null),r(t,i(L,{get when(){return e.hasValue()&&e.multiple},get children(){return i($e,{get each(){return e.value()},children:(s,a)=>i(Ye,{onRemove:()=>l(a()),get children(){return n.format(s,"value")}})})}}),null),r(t,i(qe,{get id(){return n.id},get name(){return n.name},get autofocus(){return n.autofocus},get readonly(){return n.readonly}}),null),b(s=>{const a=e.multiple,u=e.hasValue(),d=e.disabled;return a!==s._v$3&&_(t,"data-multiple",s._v$3=a),u!==s._v$4&&_(t,"data-has-value",s._v$4=u),d!==s._v$5&&_(t,"data-disabled",s._v$5=d),s},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),t})()},Qe=n=>(()=>{const e=Be.cloneNode(!0);return r(e,()=>n.children),e})(),We=n=>(()=>{const e=Re.cloneNode(!0);return r(e,()=>n.children),e})(),Ye=n=>(j(),(()=>{const e=Ze.cloneNode(!0),l=e.firstChild;return r(e,()=>n.children,l),l.$$click=t=>{t.stopPropagation(),n.onRemove()},e})()),qe=n=>{const e=j();return(()=>{const l=Ue.cloneNode(!0);return l.$$mousedown=t=>{t.stopPropagation()},l.$$keydown=t=>{e.onKeyDown(t),t.defaultPrevented||t.key==="Escape"&&(t.preventDefault(),t.stopPropagation(),t.target.blur())},W(l,"input",e.onInput,!0),b(t=>{const s=n.id,a=n.name,u=e.multiple,d=e.isActive(),S=n.autofocus,f=n.readonly,y=e.disabled;return s!==t._v$6&&_(l,"id",t._v$6=s),a!==t._v$7&&_(l,"name",t._v$7=a),u!==t._v$8&&_(l,"data-multiple",t._v$8=u),d!==t._v$9&&_(l,"data-is-active",t._v$9=d),S!==t._v$10&&(l.autofocus=t._v$10=S),f!==t._v$11&&(l.readOnly=t._v$11=f),y!==t._v$12&&(l.disabled=t._v$12=y),t},{_v$6:void 0,_v$7:void 0,_v$8:void 0,_v$9:void 0,_v$10:void 0,_v$11:void 0,_v$12:void 0}),b(()=>l.value=e.inputValue()),l})()},Xe=n=>{const e=j();return i(L,{get when(){return e.isOpen()},get children(){const l=Ge.cloneNode(!0);return r(l,i(L,{get when(){return!n.loading},get fallback(){return(()=>{const t=ge.cloneNode(!0);return r(t,()=>n.loadingPlaceholder),t})()},get children(){return i($e,{get each(){return e.options()},get fallback(){return(()=>{const t=ge.cloneNode(!0);return r(t,()=>n.emptyPlaceholder),t})()},children:t=>i(et,{option:t,get children(){return n.format(t,"option")}})})}})),l}})},et=n=>{const e=j(),l=t=>{V(()=>{e.isOptionFocused(n.option)&&t.scrollIntoView({block:"nearest"})})};return(()=>{const t=He.cloneNode(!0);return t.$$click=()=>e.pickOption(n.option),ze(l,t),r(t,()=>n.children),b(s=>{const a=e.isOptionDisabled(n.option),u=e.isOptionFocused(n.option);return a!==s._v$13&&_(t,"data-disabled",s._v$13=a),u!==s._v$14&&_(t,"data-focused",s._v$14=u),s},{_v$13:void 0,_v$14:void 0}),t})()};_e(["focusin","focusout","mousedown","click","input","keydown"]);const tt=h('<div class="flex flex-1 flex-col max-w-100 gap-3"><label for="sensor">Select sensors</label></div>',4),nt=h('<form><h3>Filter Sensors</h3><label><input type="checkbox"></label><div class="flex flex-1 flex-col max-w-100 gap-3"><label for="zip_code">Filter sensors by zip code</label></div><label><input type="checkbox"></label><div class="flex flex-1 flex-col max-w-100 gap-3"><label for="type">Filter sensors by monitor type</label></div><label><input type="checkbox"></label><div class="flex flex-1 flex-col max-w-100 gap-3"><label for="pollutant">Filter sensors by pollutant</label></div><h3>Select Sensors</h3><h3>Filter Sensor Data </h3><label class="data-form-item">Start time/date<input type="date" name="start-time" class="text-input"></label><label class="data-form-item">End time/date<input type="date" name="end-time" class="text-input"></label><label class="data-form-item">Time step<select class="select"><option value="h">Hourly</option><option value="d">Daily</option><option value="m">Monthly</option><option value="y">Yearly</option></select></label></form>',47),lt=h('<label class="data-form-item" for="downloadSubmit"><button id="downloadSubmit" type="submit" name="submit" class="icon-btn btn-secondary">Download A CSV</button></label>',4),Y=(n,e)=>({id:n,name:e});async function st(){const e=await(await fetch("https://mrapid-api3-r2oaltsiuq-uc.a.run.app/zipcodes")).json();let l=[];for(let t=0;t<e.zipcode_list.length;t++)l.push(Y(e.zipcode_list[t].zip_code,e.zipcode_list[t].zip_code));return l}async function ot(){const e=await(await fetch("https://mrapid-api3-r2oaltsiuq-uc.a.run.app/parameterList")).json();let l=[];for(let t=0;t<e.results.length;t++)l.push(Y(e.results[t].name,e.results[t].displayName+" "+e.results[t].units));return l}function at(){const n=[],e=[],l=[],[t,s]=p(n),[a,u]=p(e),[d,S]=p(l),[f,y]=p([]),[R,Z]=p(""),[k,U]=p(""),[O,q]=p(""),E=c=>{q(c.currentTarget.value)},m=c=>{console.log("got to csv download part");let C={results:[{sensor:111111,value:1},{sensor:222222,value:2},{sensor:333333,value:3}]};C=C.results;const M=C.map(B=>({sensor:B.sensor,value:B.value}));Te(M),console.log("got to csv download part"),c.preventDefault(),x()},g=()=>({zip_code:t(),type:a(),pollutant:d()}),[z]=K(g,Ne),P=c=>{y(c),z()},A=()=>({pollutant:d(),sensor:f(),start:R(),end:k(),step:O()}),[x]=K(A,Fe),[I]=K(st),G=c=>{s(c),I()},H=[Y("DST","dst full name"),Y("OAQ","open air quality")],J=c=>{u(c)},[N]=K(ot),X=c=>{S(c),N()},F=(c,C)=>c.name,[T,ee]=p({text:"Select all zip codes",complete:!1}),te=()=>{ee({...T,complete:!T.complete}),s(I),I()},[o,w]=p({text:"Select all monitor types",complete:!1}),ne=()=>{w({...o,complete:!o.complete}),u(H)},[$,ye]=p({text:"Select all pollutant types",complete:!1}),xe=()=>{ye({...$,complete:!$.complete}),S(N),N()};return[(()=>{const c=nt.cloneNode(!0),C=c.firstChild,M=C.nextSibling,B=M.firstChild,le=M.nextSibling;le.firstChild;const se=le.nextSibling,ce=se.firstChild,oe=se.nextSibling;oe.firstChild;const ae=oe.nextSibling,ue=ae.firstChild,ie=ae.nextSibling;ie.firstChild;const we=ie.nextSibling,de=we.nextSibling,pe=de.nextSibling,Ce=pe.firstChild,fe=Ce.nextSibling,he=pe.nextSibling,Ve=he.firstChild,me=Ve.nextSibling,De=he.nextSibling,ke=De.firstChild,ve=ke.nextSibling;return B.addEventListener("change",te),r(M,()=>T().text,null),r(le,i(Q,{class:"search",id:"zip_code",multiple:!0,get initialValue(){return t()},label:"Select sensors",placeholder:"Search by zip code",onChange:G,format:F,options:I,isOptionDisabled:v=>t().length!=0?t().includes(v):!1}),null),ce.addEventListener("change",ne),r(se,()=>o().text,null),r(oe,i(Q,{class:"search",id:"type",multiple:!0,label:"Select sensors",placeholder:"Search by monitor type",get initialValue(){return a()},onChange:J,format:F,options:H,isOptionDisabled:v=>a().length!=0?a().includes(v):!1}),null),ue.addEventListener("change",xe),r(ae,()=>$().text,null),r(ie,i(Q,{class:"search",id:"pollutant",multiple:!0,get initialValue(){return d()},label:"Select sensors",placeholder:"Search by pollutant",onChange:X,format:F,options:N,isOptionDisabled:v=>d().length!=0?d().includes(v):!1}),null),r(c,i(L,{get when(){return!z.loading},get fallback(){return"Searching..."},get children(){const v=tt.cloneNode(!0);return v.firstChild,r(v,i(Q,{class:"search",id:"sensor",multiple:!0,label:"sensor selector",placeholder:"Search for specific sensors",onChange:P,format:F,options:z,isOptionDisabled:Oe=>f().length!=0?f().includes(Oe):!1}),null),v}}),de),fe.addEventListener("change",v=>Z(v.currentTarget.value)),me.addEventListener("change",v=>U(v.currentTarget.value)),ve.addEventListener("change",E),b(()=>B.checked=T().complete),b(()=>ce.checked=o().complete),b(()=>ue.checked=$().complete),b(()=>fe.value=R()),b(()=>me.value=k()),b(()=>ve.value=O()),c})(),(()=>{const c=lt.cloneNode(!0),C=c.firstChild;return C.$$click=m,c})()]}_e(["click"]);const it=h("<div></div>",2),rt=h('<section class="page-data"><div class="data-form"><form><h1>Download sensor data</h1></form></div><div class="data-image-container"><h3>Map of Detroit Zip Codes</h3><div class="data-image"><img src="/src/assets/detroitmap.jpg" alt="map of detroit zipcodes"></div>For a complete list of MI zip codes, refer to this <a href="https://www.michigan.gov/dtmb/-/media/Project/Websites/dtmb/Services/GIS/Static-Maps/Boundaries/ZIPCodeMap_LP102209.pdf?rev=ef32903cd06c47688b6f3978263a40f4&amp;hash=FB40296EEACD32BC792E28F054C0E47D" target="_blank" rel="noopener noreferrer">document</a>.</div></section>',17),ct=[];function ut(){const[n]=p(ct);return(()=>{const e=it.cloneNode(!0);return r(e,i(at,{setSensors:n})),e})()}const pt=()=>(()=>{const n=rt.cloneNode(!0),e=n.firstChild,l=e.firstChild;return l.firstChild,r(l,i(ut,{name:"Solid"}),null),n})();export{pt as default};
